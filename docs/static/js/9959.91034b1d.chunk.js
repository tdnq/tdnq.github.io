"use strict";(globalThis.webpackChunktdnq_github_io=globalThis.webpackChunktdnq_github_io||[]).push([[9959,9637,8364],{9637:(e,t,i)=>{function a(e){var t;null===(t=e.querySelectorAll("canvas"))||void 0===t||t.forEach((e=>e.remove()))}i.d(t,{e:()=>a})},9959:(e,t,i)=>{i.r(t),i.d(t,{default:()=>l});var a=i(3562),n=i(2518),s=i(9637),r=i(5165),h=i(40),o=i(8364);class l{constructor(e=new Map){this.leaveCallback=()=>{var e;null===(e=this.gui)||void 0===e||e.destroy()},this.render=()=>{this.renderer.render(this.scene,this.camera)},this.animate=e=>{this.render(e),this.animationId.set("miniCity",requestAnimationFrame(this.animate))},this.animationId=e,this.scene=null,this.objects={},this.light=[],this.camera=null,this.renderer=null,this.helper=[],this.gltfLoader=new h.E,this.gltfLoader.setResourcePath("/assets/"),this.data={isHideHelper:"/"===window.location.pathname}}async init(e){this.canvasContainer=null===e||void 0===e?void 0:e.current,(0,s.e)(this.canvasContainer),this.gui=this.data.isHideHelper?null:new r.XS,this.initThree(),this.initCamera(),this.initControl(),await this.initObjects(),this.initLight(),this.initHelper(),this.initScene(),requestAnimationFrame(this.animate)}initControl(){this.control=new n.z(this.camera,this.renderer.domElement)}initThree(){this.renderer=new a.CP7,this.renderer.shadowMap.enabled=!0,this.renderer.setClearColor(14614271),this.renderer.setSize(this.canvasContainer.clientWidth,this.canvasContainer.clientHeight),this.canvasContainer.appendChild(this.renderer.domElement)}initScene(){this.scene=new a.xsS,this.scene.add(...Object.values(this.objects)),this.scene.add(...this.helper,...this.light)}initHelper(){this.data.isHideHelper||this.helper.forEach((e=>{e.material&&(e.material.depthTest=!1,e.renderOrder=2),void 0!==e.visible&&(e.visible=!1)}))}async initObjects(){await this.gltfLoader.loadAsync("/assets/model/miniCity.gltf").then((e=>{const t=e.scene;this.objects.city=t;let i=(new a.ZzF).setFromObject(t),n=i.getSize(new a.Pa4).length(),s=i.getCenter(new a.Pa4);(0,o.frameArea)(.5*n,n,s,this.camera),this.control.maxDistance=10*n,this.control.target.copy(s),this.control.update(),t.traverse((e=>{void 0!==e.castShadow&&(e.castShadow=!0,e.receiveShadow=!0)}))}))}initCamera(){this.camera=new a.cPb(60,this.canvasContainer.clientWidth/this.canvasContainer.clientHeight,1,6e3)}initLight(){{let e=new a.Mig(16777215,.6);this.light.push(e)}{let e=new a.Ox3(16777215,1);e.castShadow=!0,e.position.set(this.camera.position.x,514,this.camera.position.x),e.shadow.mapSize.width=2048,e.shadow.bias=-.004,e.shadow.mapSize.height=2048;const t=e.shadow.camera;if(t.near=1,t.far=2e3,t.left=-1500,t.right=1500,t.top=1500,t.bottom=-1500,this.light.push(e),this.data.isHideHelper)return;let i=new a.cBI(e),n=this.gui.addFolder("DirectionalLightHelper");(0,o.makeXYZGui)(n,e.position,"directionLightHelperPosition",(()=>{e.updateMatrixWorld(),e.target.updateMatrixWorld(),i.update()}),i),n.add(i,"visible").name("lightHelper").listen();let s=new a.Rki(e.shadow.camera);n.add(s,"visible").name("cameraHelper").listen(),this.helper.push(s),this.helper.push(i)}}}},8364:(e,t,i)=>{i.r(t),i.d(t,{frameArea:()=>n,makeXYZGui:()=>s});var a=i(3562);function n(e,t,i,n){let s=.5*e,r=a.M8C.degToRad(.5*n.fov),h=s/Math.tan(r),o=(new a.Pa4).subVectors(n.position,i).multiply(new a.Pa4(1,0,1)).normalize();n.position.copy(o.multiplyScalar(h).add(i)),n.near=t/100,n.far=100*t,n.updateProjectionMatrix(),n.lookAt(i)}function s(e,t,i,a=(()=>{})){return e.add(t,"x",t.x-500,t.x+500).onChange(a),e.add(t,"y",t.y-500,t.y+500).onChange(a),e.add(t,"z",t.z-500,t.z+500).onChange(a),e.open(),e}}}]);