"use strict";(self.webpackChunktdnq_github_io=self.webpackChunktdnq_github_io||[]).push([[1976,9637],{9637:function(e,t,n){function r(e){var t;null===(t=e.querySelectorAll("canvas"))||void 0===t||t.forEach((function(e){return e.remove()}))}n.d(t,{e:function(){return r}})},1976:function(e,t,n){n.r(t),n.d(t,{default:function(){return D}});var r=n(3433),i=n(5861),s=n(5671),a=n(3144),o=n(7757),l=n.n(o),u=n(3562),h=n(2518),c=n(9637),f=n(5165),d={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor = opacity * texel;\n\n\t\t}"},v=n(136),m=n(4062),p=function(){function e(){(0,s.Z)(this,e),this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}return(0,a.Z)(e,[{key:"setSize",value:function(){}},{key:"render",value:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}]),e}(),g=new u.iKG(-1,1,1,-1,0,1),w=new u.u9r;w.setAttribute("position",new u.a$l([-1,3,0,-1,-1,0,3,-1,0],3)),w.setAttribute("uv",new u.a$l([0,2,0,0,2,0],2));var y=function(){function e(t){(0,s.Z)(this,e),this._mesh=new u.Kj0(w,t)}return(0,a.Z)(e,[{key:"dispose",value:function(){this._mesh.geometry.dispose()}},{key:"render",value:function(e){e.render(this._mesh,g)}},{key:"material",get:function(){return this._mesh.material},set:function(e){this._mesh.material=e}}]),e}(),x=function(e){(0,v.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var i;return(0,s.Z)(this,n),(i=t.call(this)).textureID=void 0!==r?r:"tDiffuse",e instanceof u.jyz?(i.uniforms=e.uniforms,i.material=e):e&&(i.uniforms=u.rDY.clone(e.uniforms),i.material=new u.jyz({defines:Object.assign({},e.defines),uniforms:i.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),i.fsQuad=new y(i.material),i}return(0,a.Z)(n,[{key:"render",value:function(e,t,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}}]),n}(p),S=function(e){(0,v.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var i;return(0,s.Z)(this,n),(i=t.call(this)).scene=e,i.camera=r,i.clear=!0,i.needsSwap=!1,i.inverse=!1,i}return(0,a.Z)(n,[{key:"render",value:function(e,t,n){var r,i,s=e.getContext(),a=e.state;a.buffers.color.setMask(!1),a.buffers.depth.setMask(!1),a.buffers.color.setLocked(!0),a.buffers.depth.setLocked(!0),this.inverse?(r=0,i=1):(r=1,i=0),a.buffers.stencil.setTest(!0),a.buffers.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),a.buffers.stencil.setFunc(s.ALWAYS,r,4294967295),a.buffers.stencil.setClear(i),a.buffers.stencil.setLocked(!0),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),a.buffers.color.setLocked(!1),a.buffers.depth.setLocked(!1),a.buffers.stencil.setLocked(!1),a.buffers.stencil.setFunc(s.EQUAL,1,4294967295),a.buffers.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),a.buffers.stencil.setLocked(!0)}}]),n}(p),T=function(e){(0,v.Z)(n,e);var t=(0,m.Z)(n);function n(){var e;return(0,s.Z)(this,n),(e=t.call(this)).needsSwap=!1,e}return(0,a.Z)(n,[{key:"render",value:function(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}]),n}(p),C=function(){function e(t,n){if((0,s.Z)(this,e),this.renderer=t,void 0===n){var r={minFilter:u.wem,magFilter:u.wem,format:u.wk1},i=t.getSize(new u.FM8);this._pixelRatio=t.getPixelRatio(),this._width=i.width,this._height=i.height,(n=new u.dd2(this._width*this._pixelRatio,this._height*this._pixelRatio,r)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=n.width,this._height=n.height;this.renderTarget1=n,this.renderTarget2=n.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],void 0===d&&console.error("THREE.EffectComposer relies on CopyShader"),void 0===x&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new x(d),this.clock=new u.SUY}return(0,a.Z)(e,[{key:"swapBuffers",value:function(){var e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}},{key:"addPass",value:function(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}},{key:"insertPass",value:function(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}},{key:"removePass",value:function(e){var t=this.passes.indexOf(e);-1!==t&&this.passes.splice(t,1)}},{key:"isLastEnabledPass",value:function(e){for(var t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}},{key:"render",value:function(e){void 0===e&&(e=this.clock.getDelta());for(var t=this.renderer.getRenderTarget(),n=!1,r=0,i=this.passes.length;r<i;r++){var s=this.passes[r];if(!1!==s.enabled){if(s.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(r),s.render(this.renderer,this.writeBuffer,this.readBuffer,e,n),s.needsSwap){if(n){var a=this.renderer.getContext(),o=this.renderer.state.buffers.stencil;o.setFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),o.setFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==S&&(s instanceof S?n=!0:s instanceof T&&(n=!1))}}this.renderer.setRenderTarget(t)}},{key:"reset",value:function(e){if(void 0===e){var t=this.renderer.getSize(new u.FM8);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}},{key:"setSize",value:function(e,t){this._width=e,this._height=t;var n=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(n,r),this.renderTarget2.setSize(n,r);for(var i=0;i<this.passes.length;i++)this.passes[i].setSize(n,r)}},{key:"setPixelRatio",value:function(e){this._pixelRatio=e,this.setSize(this._width,this._height)}}]),e}(),_=(new u.iKG(-1,1,1,-1,0,1),new u.u9r);_.setAttribute("position",new u.a$l([-1,3,0,-1,-1,0,3,-1,0],3)),_.setAttribute("uv",new u.a$l([0,2,0,0,2,0],2));var b=function(e){(0,v.Z)(n,e);var t=(0,m.Z)(n);function n(e,r,i,a,o){var l;return(0,s.Z)(this,n),(l=t.call(this)).scene=e,l.camera=r,l.overrideMaterial=i,l.clearColor=a,l.clearAlpha=void 0!==o?o:0,l.clear=!0,l.clearDepth=!1,l.needsSwap=!1,l._oldClearColor=new u.Ilk,l}return(0,a.Z)(n,[{key:"render",value:function(e,t,n){var r,i,s=e.autoClear;e.autoClear=!1,void 0!==this.overrideMaterial&&(i=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(e.getClearColor(this._oldClearColor),r=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:n),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(this._oldClearColor,r),void 0!==this.overrideMaterial&&(this.scene.overrideMaterial=i),e.autoClear=s}}]),n}(p),E={defines:{KERNEL_SIZE_FLOAT:"25.0",KERNEL_SIZE_INT:"25"},uniforms:{tDiffuse:{value:null},uImageIncrement:{value:new u.FM8(.001953125,0)},cKernel:{value:[]}},vertexShader:"\n\n\t\tuniform vec2 uImageIncrement;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv - ( ( KERNEL_SIZE_FLOAT - 1.0 ) / 2.0 ) * uImageIncrement;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float cKernel[ KERNEL_SIZE_INT ];\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform vec2 uImageIncrement;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec2 imageCoord = vUv;\n\t\t\tvec4 sum = vec4( 0.0, 0.0, 0.0, 0.0 );\n\n\t\t\tfor( int i = 0; i < KERNEL_SIZE_INT; i ++ ) {\n\n\t\t\t\tsum += texture2D( tDiffuse, imageCoord ) * cKernel[ i ];\n\t\t\t\timageCoord += uImageIncrement;\n\n\t\t\t}\n\n\t\t\tgl_FragColor = sum;\n\n\t\t}",buildKernel:function(e){var t=2*Math.ceil(3*e)+1;t>25&&(t=25);for(var n=.5*(t-1),r=new Array(t),i=0,s=0;s<t;++s)r[s]=R(s-n,e),i+=r[s];for(var a=0;a<t;++a)r[a]/=i;return r}};function R(e,t){return Math.exp(-e*e/(2*t*t))}var k=function(e){(0,v.Z)(n,e);var t=(0,m.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:256;(0,s.Z)(this,n),e=t.call(this);var l={minFilter:u.wem,magFilter:u.wem,format:u.wk1};e.renderTargetX=new u.dd2(o,o,l),e.renderTargetX.texture.name="BloomPass.x",e.renderTargetY=new u.dd2(o,o,l),e.renderTargetY.texture.name="BloomPass.y",void 0===d&&console.error("THREE.BloomPass relies on CopyShader");var h=d;e.copyUniforms=u.rDY.clone(h.uniforms),e.copyUniforms.opacity.value=r,e.materialCopy=new u.jyz({uniforms:e.copyUniforms,vertexShader:h.vertexShader,fragmentShader:h.fragmentShader,blending:u.WMw,transparent:!0}),void 0===E&&console.error("THREE.BloomPass relies on ConvolutionShader");var c=E;return e.convolutionUniforms=u.rDY.clone(c.uniforms),e.convolutionUniforms.uImageIncrement.value=n.blurX,e.convolutionUniforms.cKernel.value=E.buildKernel(a),e.materialConvolution=new u.jyz({uniforms:e.convolutionUniforms,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,defines:{KERNEL_SIZE_FLOAT:i.toFixed(1),KERNEL_SIZE_INT:i.toFixed(0)}}),e.needsSwap=!1,e.fsQuad=new y(null),e}return(0,a.Z)(n,[{key:"render",value:function(e,t,r,i,s){s&&e.state.buffers.stencil.setTest(!1),this.fsQuad.material=this.materialConvolution,this.convolutionUniforms.tDiffuse.value=r.texture,this.convolutionUniforms.uImageIncrement.value=n.blurX,e.setRenderTarget(this.renderTargetX),e.clear(),this.fsQuad.render(e),this.convolutionUniforms.tDiffuse.value=this.renderTargetX.texture,this.convolutionUniforms.uImageIncrement.value=n.blurY,e.setRenderTarget(this.renderTargetY),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetY.texture,s&&e.state.buffers.stencil.setTest(!0),e.setRenderTarget(r),this.clear&&e.clear(),this.fsQuad.render(e)}}]),n}(p);k.blurX=new u.FM8(.001953125,0),k.blurY=new u.FM8(0,.001953125);var Z={uniforms:{tDiffuse:{value:null},time:{value:0},nIntensity:{value:.5},sIntensity:{value:.05},sCount:{value:4096},grayscale:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\t#include <common>\n\n\t\t// control parameter\n\t\tuniform float time;\n\n\t\tuniform bool grayscale;\n\n\t\t// noise effect intensity value (0 = no effect, 1 = full effect)\n\t\tuniform float nIntensity;\n\n\t\t// scanlines effect intensity value (0 = no effect, 1 = full effect)\n\t\tuniform float sIntensity;\n\n\t\t// scanlines effect count value (0 = no effect, 4096 = full effect)\n\t\tuniform float sCount;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t// sample the source\n\t\t\tvec4 cTextureScreen = texture2D( tDiffuse, vUv );\n\n\t\t// make some noise\n\t\t\tfloat dx = rand( vUv + time );\n\n\t\t// add noise\n\t\t\tvec3 cResult = cTextureScreen.rgb + cTextureScreen.rgb * clamp( 0.1 + dx, 0.0, 1.0 );\n\n\t\t// get us a sine and cosine\n\t\t\tvec2 sc = vec2( sin( vUv.y * sCount ), cos( vUv.y * sCount ) );\n\n\t\t// add scanlines\n\t\t\tcResult += cTextureScreen.rgb * vec3( sc.x, sc.y, sc.x ) * sIntensity;\n\n\t\t// interpolate between source and result by intensity\n\t\t\tcResult = cTextureScreen.rgb + clamp( nIntensity, 0.0,1.0 ) * ( cResult - cTextureScreen.rgb );\n\n\t\t// convert to grayscale if desired\n\t\t\tif( grayscale ) {\n\n\t\t\t\tcResult = vec3( cResult.r * 0.3 + cResult.g * 0.59 + cResult.b * 0.11 );\n\n\t\t\t}\n\n\t\t\tgl_FragColor =  vec4( cResult, cTextureScreen.a );\n\n\t\t}"},I=function(e){(0,v.Z)(n,e);var t=(0,m.Z)(n);function n(e,r,i,a){var o;(0,s.Z)(this,n),o=t.call(this),void 0===Z&&console.error("THREE.FilmPass relies on FilmShader");var l=Z;return o.uniforms=u.rDY.clone(l.uniforms),o.material=new u.jyz({uniforms:o.uniforms,vertexShader:l.vertexShader,fragmentShader:l.fragmentShader}),void 0!==a&&(o.uniforms.grayscale.value=a),void 0!==e&&(o.uniforms.nIntensity.value=e),void 0!==r&&(o.uniforms.sIntensity.value=r),void 0!==i&&(o.uniforms.sCount.value=i),o.fsQuad=new y(o.material),o}return(0,a.Z)(n,[{key:"render",value:function(e,t,n,r){this.uniforms.tDiffuse.value=n.texture,this.uniforms.time.value+=r,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}}]),n}(p),D=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Map;(0,s.Z)(this,e),this.leaveCallback=function(){var e;null===(e=t.gui)||void 0===e||e.destroy()},this.render=function(e){var n=t.thenTime-.001*e;t.thenTime=.001*e,t.objects.box.children.forEach((function(e){e.rotation.set(t.thenTime,t.thenTime,t.thenTime)})),t.composer.render(n)},this.animate=function(e){t.render(e),t.animationId.set("postProcessDemo",requestAnimationFrame(t.animate))},this.animationId=n,this.scene=null,this.objects={},this.light=[],this.camera=null,this.renderer=null,this.helper=[],this.composer=null,this.thenTime=0,this.data={isHideHelper:"/"===window.location.pathname},this.gui=this.data.isHideHelper?null:new f.XS}return(0,a.Z)(e,[{key:"init",value:function(){var e=(0,i.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.canvasContainer=null===t||void 0===t?void 0:t.current,(0,c.e)(this.canvasContainer),this.initThree(),this.initCamera(),this.initControl(),e.next=7,this.initObjects();case 7:return this.initLight(),this.initHelper(),e.next=11,this.initScene();case 11:this.initPass(),requestAnimationFrame(this.animate);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"initPass",value:function(){var e=new C(this.renderer);e.addPass(new b(this.scene,this.camera));var t=new k(1,25,4,256);e.addPass(t);var n=new I(.35,.025,628,!1);n.renderToScreen=!0,e.addPass(n),this.composer=e}},{key:"initControl",value:function(){this.control=new h.z(this.camera,this.renderer.domElement)}},{key:"initThree",value:function(){this.renderer=new u.CP7,this.renderer.setSize(this.canvasContainer.clientWidth,this.canvasContainer.clientHeight),this.canvasContainer.appendChild(this.renderer.domElement)}},{key:"initScene",value:function(){var e=(0,i.Z)(l().mark((function e(){var t,n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.scene=new u.xsS,(t=this.scene).add.apply(t,(0,r.Z)(Object.values(this.objects))),(n=this.scene).add.apply(n,(0,r.Z)(this.helper).concat((0,r.Z)(this.light)));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initHelper",value:function(){this.data.isHideHelper||this.helper.forEach((function(e){e.material&&(e.material.depthTest=!1,e.renderOrder=2),void 0!==e.visible&&(e.visible=!1)}))}},{key:"initObjects",value:function(){var e=(0,i.Z)(l().mark((function e(){var t,n,r,i,s;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=new u.DvJ(.3,.3,.3),n=new u.ZAu,r=0;r<3;r++)i=new u.xoR({color:16777215*Math.random()}),(s=new u.Kj0(t,i)).position.setX(.45*r-.5),n.add(s);this.objects.box=n;case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initCamera",value:function(){this.camera=new u.cPb(45,this.canvasContainer.clientWidth/this.canvasContainer.clientHeight,.1,2),this.camera.position.set(0,0,1),this.camera.lookAt(0,0,0)}},{key:"initLight",value:function(){var e=new u.Mig(16777215,.6);this.light.push(e)}}]),e}()}}]);