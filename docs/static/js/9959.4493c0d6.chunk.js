"use strict";(self.webpackChunktdnq_github_io=self.webpackChunktdnq_github_io||[]).push([[9959,9637,8364],{9637:function(e,t,i){function n(e){var t;null===(t=e.querySelectorAll("canvas"))||void 0===t||t.forEach((function(e){return e.remove()}))}i.d(t,{e:function(){return n}})},9959:function(e,t,i){i.r(t),i.d(t,{default:function(){return f}});var n=i(3433),a=i(5861),r=i(5671),s=i(3144),o=i(7757),h=i.n(o),c=i(3562),l=i(2518),u=i(9637),d=i(5165),p=i(40),v=i(8364),f=function(){function e(){var t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Map;(0,r.Z)(this,e),this.leaveCallback=function(){var e;null===(e=t.gui)||void 0===e||e.destroy()},this.render=function(){t.renderer.render(t.scene,t.camera)},this.animate=function(e){t.render(e),t.animationId.set("miniCity",requestAnimationFrame(t.animate))},this.animationId=i,this.scene=null,this.objects={},this.light=[],this.camera=null,this.renderer=null,this.helper=[],this.gltfLoader=new p.E,this.gltfLoader.setResourcePath("/assets/"),this.data={isHideHelper:"/"===window.location.pathname}}return(0,s.Z)(e,[{key:"init",value:function(){var e=(0,a.Z)(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.canvasContainer=null===t||void 0===t?void 0:t.current,(0,u.e)(this.canvasContainer),this.gui=this.data.isHideHelper?null:new d.XS,this.initThree(),this.initCamera(),this.initControl(),e.next=8,this.initObjects();case 8:this.initLight(),this.initHelper(),this.initScene(),requestAnimationFrame(this.animate);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"initControl",value:function(){this.control=new l.z(this.camera,this.renderer.domElement)}},{key:"initThree",value:function(){this.renderer=new c.CP7,this.renderer.shadowMap.enabled=!0,this.renderer.setClearColor(14614271),this.renderer.setSize(this.canvasContainer.clientWidth,this.canvasContainer.clientHeight),this.canvasContainer.appendChild(this.renderer.domElement)}},{key:"initScene",value:function(){var e,t;this.scene=new c.xsS,(e=this.scene).add.apply(e,(0,n.Z)(Object.values(this.objects))),(t=this.scene).add.apply(t,(0,n.Z)(this.helper).concat((0,n.Z)(this.light)))}},{key:"initHelper",value:function(){this.data.isHideHelper||this.helper.forEach((function(e){e.material&&(e.material.depthTest=!1,e.renderOrder=2),void 0!==e.visible&&(e.visible=!1)}))}},{key:"initObjects",value:function(){var e=(0,a.Z)(h().mark((function e(){var t=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.gltfLoader.loadAsync("/assets/model/miniCity.gltf").then((function(e){var i=e.scene;t.objects.city=i;var n=(new c.ZzF).setFromObject(i),a=n.getSize(new c.Pa4).length(),r=n.getCenter(new c.Pa4);(0,v.frameArea)(.5*a,a,r,t.camera),t.control.maxDistance=10*a,t.control.target.copy(r),t.control.update(),i.traverse((function(e){void 0!==e.castShadow&&(e.castShadow=!0,e.receiveShadow=!0)}))}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initCamera",value:function(){this.camera=new c.cPb(60,this.canvasContainer.clientWidth/this.canvasContainer.clientHeight,1,6e3)}},{key:"initLight",value:function(){var e=new c.Mig(16777215,.6);this.light.push(e);var t=new c.Ox3(16777215,1);t.castShadow=!0,t.position.set(this.camera.position.x,514,this.camera.position.x),t.shadow.mapSize.width=2048,t.shadow.bias=-.004,t.shadow.mapSize.height=2048;var i=t.shadow.camera;if(i.near=1,i.far=2e3,i.left=-1500,i.right=1500,i.top=1500,i.bottom=-1500,this.light.push(t),!this.data.isHideHelper){var n=new c.cBI(t),a=this.gui.addFolder("DirectionalLightHelper");(0,v.makeXYZGui)(a,t.position,"directionLightHelperPosition",(function(){t.updateMatrixWorld(),t.target.updateMatrixWorld(),n.update()}),n),a.add(n,"visible").name("lightHelper").listen();var r=new c.Rki(t.shadow.camera);a.add(r,"visible").name("cameraHelper").listen(),this.helper.push(r),this.helper.push(n)}}}]),e}()},8364:function(e,t,i){i.r(t),i.d(t,{frameArea:function(){return a},makeXYZGui:function(){return r}});var n=i(3562);function a(e,t,i,a){var r=.5*e,s=n.M8C.degToRad(.5*a.fov),o=r/Math.tan(s),h=(new n.Pa4).subVectors(a.position,i).multiply(new n.Pa4(1,0,1)).normalize();a.position.copy(h.multiplyScalar(o).add(i)),a.near=t/100,a.far=100*t,a.updateProjectionMatrix(),a.lookAt(i)}function r(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};return e.add(t,"x",t.x-500,t.x+500).onChange(n),e.add(t,"y",t.y-500,t.y+500).onChange(n),e.add(t,"z",t.z-500,t.z+500).onChange(n),e.open(),e}}}]);